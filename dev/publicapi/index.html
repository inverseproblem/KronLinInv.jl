<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · KronLinInv.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>KronLinInv.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li class="current"><a class="toctext" href>API</a><ul class="internal"></ul></li></ul></nav><article id="docs"><header><nav><ul><li><a href>API</a></li></ul><a class="edit-page" href="https://github.com/inverseproblem/KronLinInv.jl/blob/master/docs/src/publicapi.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>API</span><a class="fa fa-bars" href="#"></a></div></header><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KronLinInv.FwdOps" href="#KronLinInv.FwdOps"><code>KronLinInv.FwdOps</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">FwdOps</code></pre><p>A structure containing the three forward model matrices  G1, G2, G3, where  <span>$\mathbf{G} =  \mathbf{G_1} \otimes \mathbf{G_2} \otimes \mathbf{G_3}$</span></p></div></div><a class="source-link" target="_blank" href="https://github.com/inverseproblem/KronLinInv.jl/blob/f2d5df3f1ed3011d732a5c8958ea6d4044e2af77/src/kronlininv_parallel.jl#L9-L14">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KronLinInv.CovMats" href="#KronLinInv.CovMats"><code>KronLinInv.CovMats</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">CovMats</code></pre><p>A structure containing the six covariance matrices <code>Cm1, Cm2, Cm3, Cd1, Cd2, Cd3</code>, where <span>$\mathbf{C}_{\rm{M}} = \mathbf{C}_{\rm{M}}^{\rm{x}} \otimes  \mathbf{C}_{\rm{M}}^{\rm{y}} \otimes \mathbf{C}_{\rm{M}}^{\rm{z}}$</span>  and <span>$\quad \mathbf{C}_{\rm{D}} = \mathbf{C}_{\rm{D}}^{\rm{x}} \otimes  \mathbf{C}_{\rm{D}}^{\rm{y}} \otimes \mathbf{C}_{\rm{D}}^{\rm{z}}$</span></p></div></div><a class="source-link" target="_blank" href="https://github.com/inverseproblem/KronLinInv.jl/blob/f2d5df3f1ed3011d732a5c8958ea6d4044e2af77/src/kronlininv_parallel.jl#L22-L31">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KronLinInv.KLIFactors" href="#KronLinInv.KLIFactors"><code>KronLinInv.KLIFactors</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">KLIFactors</code></pre><p>A structure containing all the factors necessary to perform further calculations with KronLinInv, as, for instance, computations of the posterior mean model or the posterior covariance matrix. The structure includes:</p><ul><li><code>U1, U2, U3</code>:  <span>$\mathbf{U}_1$</span>, <span>$\mathbf{U}_2$</span>, <span>$\mathbf{U}_3$</span>  of  <span>$F_{\sf{A}}$</span> </li><li><code>invlambda</code>:  <span>$\big( \mathbf{I} + \mathbf{\Lambda}_1\!  \otimes \! \mathbf{\Lambda}_2 \!  \otimes\!  \mathbf{\Lambda}_3 \big)^{-1}$</span>  of <span>$F_{\sf{B}}$</span></li><li><code>iUCm1, iUCm2, iUCm3</code>:  <span>$\mathbf{U}_1^{-1} \mathbf{C}_{\rm{M}}^{\rm{x}}$</span>, <span>$\mathbf{U}_2^{-1}  \mathbf{C}_{\rm{M}}^{\rm{y}}$</span>, <span>$\mathbf{U}_2^{-1}  \mathbf{C}_{\rm{M}}^{\rm{z}}$</span> of  <span>$F_{\sf{C}}$</span> </li><li><code>iUCmGtiCd1, iUCmGtiCd1, iUCmGtiCd1</code>:   <span>$\mathbf{U}_1^{-1} \mathbf{C}_{\rm{M}}^{\rm{x}} (\mathbf{G}^{\rm{x}})^{\sf{T}}(\mathbf{C}_{\rm{D}}^{\rm{x}})^{-1}$</span>, <span>$\mathbf{U}_2^{-1} \mathbf{C}_{\rm{M}}^{\rm{y}} (\mathbf{G}^{\rm{y}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{y}})^{-1}$</span>, <span>$\mathbf{U}_3^{-1} \mathbf{C}_{\rm{M}}^{\rm{z}} (\mathbf{G}^{\rm{z}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{z}})^{-1}$</span> of  <span>$F_{\sf{D}}$</span></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/inverseproblem/KronLinInv.jl/blob/f2d5df3f1ed3011d732a5c8958ea6d4044e2af77/src/kronlininv_parallel.jl#L42-L62">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KronLinInv.calcfactors" href="#KronLinInv.calcfactors"><code>KronLinInv.calcfactors</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">calcfactors(Gfwd::FwdOps,Covs::CovMats)</code></pre><p>Computes the factors necessary to solve the inverse problem. </p><p>The factors are the ones to be stored to subsequently calculate posterior   mean and covariance. First an eigen decomposition is performed, to get</p><div>\[   \mathbf{U}_1 \mathbf{\Lambda}_1  \mathbf{U}_1^{-1}  
   = \mathbf{C}_{\rm{M}}^{\rm{x}} (\mathbf{G}^{\rm{x}})^{\sf{T}}
  (\mathbf{C}_{\rm{D}}^{\rm{x}})^{-1} \mathbf{G}^{\rm{x}}\]</div><div>\[ \mathbf{U}_2 \mathbf{\Lambda}_2  \mathbf{U}_2^{-1}
  =  \mathbf{C}_{\rm{M}}^{\rm{y}} (\mathbf{G}^{\rm{y}})^{\sf{T}}
  (\mathbf{C}_{\rm{D}}^{\rm{y}})^{-1} \mathbf{G}^{\rm{y}}\]</div><div>\[  \mathbf{U}_3 \mathbf{\Lambda}_3  \mathbf{U}_3^{-1}
  = \mathbf{C}_{\rm{M}}^{\rm{z}} (\mathbf{G}^{\rm{z}})^{\sf{T}}
  (\mathbf{C}_{\rm{D}}^{\rm{z}})^{-1} \mathbf{G}^{\rm{z}} \]</div><p>The principal factors involved in the computation of the posterior covariance and   mean are:</p><div>\[  F_{\sf{A}} =  \mathbf{U}_1 \otimes \mathbf{U}_2 \otimes \mathbf{U}_3 \]</div><div>\[  F_{\sf{B}} = \big( 
  \mathbf{I} + \mathbf{\Lambda}_1 \! \otimes \! \mathbf{\Lambda}_2 \!
  \otimes \! \mathbf{\Lambda}_3 
  \big)^{-1} \]</div><div>\[  F_{\sf{C}} =
  \mathbf{U}_1^{-1}  \mathbf{C}_{\rm{M}}^{\rm{x}} \otimes 
  \mathbf{U}_2^{-1} \mathbf{C}_{\rm{M}}^{\rm{y}} \otimes 
  \mathbf{U}_3^{-1} \mathbf{C}_{\rm{M}}^{\rm{z}} \]</div><div>\[  F_{\sf{D}} =   
  \left( \mathbf{U}_1^{-1}  \mathbf{C}_{\rm{M}}^{\rm{x}} (\mathbf{G}^{\rm{x}})^{\sf{T}}
  (\mathbf{C}_{\rm{D}}^{\rm{x}})^{-1} \right) \!    \otimes 
  \left( \mathbf{U}_2^{-1} \mathbf{C}_{\rm{M}}^{\rm{y}}  (\mathbf{G}^{\rm{y}})^{\sf{T}}
  (\mathbf{C}_{\rm{D}}^{\rm{y}})^{-1}  \right)   \!   
  \otimes  \left( \mathbf{U}_3^{-1} \mathbf{C}_{\rm{M}}^{\rm{z}}
  (\mathbf{G}^{\rm{z}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{z}})^{-1} \right)\]</div><p>Uses LAPACK.sygvd!(), see <a href="http://www.netlib.org/lapack/lug/node54.html">http://www.netlib.org/lapack/lug/node54.html</a>.   Reduces a real symmetric-definite generalized eigenvalue problem to   the standard form. \n   <span>$B A z = \lambda z$</span> 	B = LLT 	C = LT A L 	z = L y</p><ul><li>A is symmetric</li><li>B is symmetric, positive definite</li></ul><p><strong>Arguments</strong></p><ul><li><code>Gfwd</code>: a <a href="#KronLinInv.FwdOps"><code>FwdOps</code></a> structure containing the three forward model matrices  G1, G2 and G3, where     <span>$\mathbf{G} =  \mathbf{G_1} \otimes \mathbf{G_2} \otimes \mathbf{G_3}$</span></li><li><code>Covs</code>: a <a href="#KronLinInv.CovMats"><code>CovMats</code></a> structure containing the six covariance matrices <span>$\mathbf{C}_{\rm{M}} = \mathbf{C}_{\rm{M}}^{\rm{x}} \otimes \mathbf{C}_{\rm{M}}^{\rm{y}} \otimes \mathbf{C}_{\rm{M}}^{\rm{z}}$</span> and <span>$\mathbf{C}_{\rm{D}} = \mathbf{C}_{\rm{D}}^{\rm{x}} \otimes \mathbf{C}_{\rm{D}}^{\rm{y}} \otimes \mathbf{C}_{\rm{D}}^{\rm{z}}$</span></li></ul><p><strong>Returns</strong></p><ul><li><p>A <a href="#KronLinInv.KLIFactors"><code>KLIFactors</code></a> structure containing all the &quot;factors&quot; necessary to perform further calculations with KronLinInv,   as, for instance, computations of the posterior mean model or the posterior covariance matrix.    The structure includes:</p><ul><li><code>U1, U2, U3</code>:  <span>$\mathbf{U}_1$</span>, <span>$\mathbf{U}_2$</span>, <span>$\mathbf{U}_3$</span>  of  <span>$F_{\sf{A}}$</span> </li><li><code>invlambda</code>:  <span>$F_{\sf{B}}$</span></li><li><code>iUCm1, iUCm2, iUCm3</code>:  <span>$\mathbf{U}_1^{-1} \mathbf{C}_{\rm{M}}^{\rm{x}}$</span>,  <span>$\mathbf{U}_2^{-1}  \mathbf{C}_{\rm{M}}^{\rm{y}}$</span>,   <span>$\mathbf{U}_2^{-1}  \mathbf{C}_{\rm{M}}^{\rm{z}}$</span> of  <span>$F_{\sf{C}}$</span> </li><li><code>iUCmGtiCd1, iUCmGtiCd1, iUCmGtiCd1</code>:  <span>$\mathbf{U}_1^{-1}   \mathbf{C}_{\rm{M}}^{\rm{x}}   (\mathbf{G}^{\rm{x}})^{\sf{T}}(\mathbf{C}_{\rm{D}}^{\rm{x}})^{-1}$</span>,   <span>$\mathbf{U}_2^{-1} \mathbf{C}_{\rm{M}}^{\rm{y}}   (\mathbf{G}^{\rm{y}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{y}})^{-1}$</span>,   <span>$\mathbf{U}_3^{-1} \mathbf{C}_{\rm{M}}^{\rm{z}}   (\mathbf{G}^{\rm{z}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{z}})^{-1}$</span>   of  <span>$F_{\sf{D}}$</span> </li></ul></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/inverseproblem/KronLinInv.jl/blob/f2d5df3f1ed3011d732a5c8958ea6d4044e2af77/src/kronlininv_parallel.jl#L80-L170">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KronLinInv.posteriormean" href="#KronLinInv.posteriormean"><code>KronLinInv.posteriormean</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">posteriormean(klifac::KLIFactors,Gfwd::FwdOps,mprior::Array{Float64,1},
              dobs::Array{Float64,1})</code></pre><p>Computes the posterior mean model.</p><p><strong>Arguments</strong></p><ul><li><code>klifac</code>: a structure containing the required &quot;factors&quot; previously computed with    the function <code>calcfactors()</code>. It includes<ul><li><code>U1, U2, U3</code> <span>$\mathbf{U}_1$</span>, <span>$\mathbf{U}_2$</span>, <span>$\mathbf{U}_3$</span>  of  <span>$F_{\sf{A}}$</span></li><li><code>diaginvlambda</code> <span>$F_{\sf{B}}$</span></li><li><code>iUCmGtiCd1, iUCmGtiCd2, iUCmGtiCd3</code> <span>$\mathbf{U}_1^{-1} \mathbf{C}_{\rm{M}}^{\rm{x}} (\mathbf{G}^{\rm{x}})^{\sf{T}}(\mathbf{C}_{\rm{D}}^{\rm{x}})^{-1}$</span>, <span>$\mathbf{U}_2^{-1} \mathbf{C}_{\rm{M}}^{\rm{y}} (\mathbf{G}^{\rm{y}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{y}})^{-1}$</span>, <span>$\mathbf{U}_3^{-1} \mathbf{C}_{\rm{M}}^{\rm{z}} (\mathbf{G}^{\rm{z}})^{\sf{T}} (\mathbf{C}_{\rm{D}}^{\rm{z}})^{-1}$</span> of  <span>$F_{\sf{D}}$</span></li></ul></li><li><code>FwdOps</code>: a structure containing the three forward matrices<ul><li><code>G1, G2, G3</code> <span>$\mathbf{G} = \mathbf{G_1} \otimes \mathbf{G_2} \otimes \mathbf{G_3}$</span></li></ul></li><li><code>mprior</code>: prior model (vector)</li><li><code>dobs</code>:  observed data (vector)</li></ul><p><strong>Returns</strong></p><ul><li>The posterior mean model (vector)</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/inverseproblem/KronLinInv.jl/blob/f2d5df3f1ed3011d732a5c8958ea6d4044e2af77/src/kronlininv_parallel.jl#L246-L272">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="KronLinInv.blockpostcov" href="#KronLinInv.blockpostcov"><code>KronLinInv.blockpostcov</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">blockpostcov(klifac::KLIFactors,astart::Int64,aend::Int64,
             bstart::Int64,bend::Int64 )</code></pre><p>Computes a block of the posterior covariance. </p><p><strong>Arguments</strong></p><ul><li><code>klifac</code>: a structure containing the required &quot;factors&quot; previously computed with    the function <code>calcfactors()</code>. It includes<ul><li>U1,U2,U3 <span>$\mathbf{U}_1$</span>, <span>$\mathbf{U}_2$</span>, <span>$\mathbf{U}_3$</span> of <span>$F_{\sf{A}}$</span></li><li>diaginvlambda <span>$F_{\sf{B}}$</span>p</li><li>iUCm1, iUCm2, iUCm3  <span>$\mathbf{U}_1^{-1} \mathbf{C}_{\rm{M}}^{\rm{x}}$</span>, <span>$\mathbf{U}_2^{-1}  \mathbf{C}_{\rm{M}}^{\rm{y}}$</span>, <span>$\mathbf{U}_2^{-1}  \mathbf{C}_{\rm{M}}^{\rm{z}}$</span> of  <span>$F_{\sf{C}}$</span> </li></ul></li><li><code>astart, aend</code>: indices of the first and last rowa of the requested block</li><li><code>bstart, bend</code>: indices of the first and last columns of the requested block</li></ul><p><strong>Returns</strong></p><ul><li>The requested block of the posterior covariance.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/inverseproblem/KronLinInv.jl/blob/f2d5df3f1ed3011d732a5c8958ea6d4044e2af77/src/kronlininv_parallel.jl#L560-L581">source</a></section><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">Home</span></a></footer></article></body></html>
